{{ define "main" }}

<!-- $pages -->
{{ $pages := union .RegularPages .Sections }}
{{ if .IsHome }}
{{ $pages = where site.RegularPages "Type" "in" site.Params.mainSections }}
{{ end }}

<!-- Paginator -->
{{ $paginator := .Paginate $pages }}

<!-- Hero Section -->
{{ if .IsHome }}
<div class="relative">
  {{ $avatar_url := $.Scratch.Get "avatar_url" }}
  {{ if or $avatar_url site.Params.name }}
  <div class="hero-container">
    {{ if $avatar_url }}
    <div class="avatar-container">
      <img 
        class="avatar-image avatar-spin" 
        src="{{ $avatar_url }}" 
        alt="{{ site.Params.name | default site.Title }}" 
      />
    </div>
    {{ end }}
    {{ if site.Params.name }}
    <div class="hero-text-content">
      <div class="hero-title">{{ site.Params.name }}</div>
      <div class="hero-subtitle">{{ site.Params.bio | default "ML Engineer | Data Scientist" }}</div>
      <div class="hero-bio">
        {{ site.Params.description | default "ML Engineer and Data Scientist who loves turning data into solutions." }}
      </div>
    </div>
    {{ end }}
  </div>
  {{ end }}

  <!-- Projects Section Header -->
  <h2 class="section-heading projects-title">Projects</h2>
</div>
{{ end }}

<!-- Project List -->
<div class="projects-container">
  {{ range $paginator.Pages }}
  <article class="project-card">
    <a href="{{ .Permalink }}" class="project-card-link">
      <h3 class="project-title">{{ .Title }}</h3>
      
      {{ with .Params.description }}
      <p class="project-description">{{ . }}</p>
      {{ end }}
    </a>
    
    {{ with .Params.tags }}
    <div class="project-tags flex flex-wrap gap-2">
      {{ range . }}
      <a href="{{ `/tags/` | relLangURL }}{{ . | urlize }}" class="project-tag">
        {{ . }}
      </a>
      {{ end }}
    </div>
    {{ end }}
  </article>
  {{ end }}
</div>

{{ end }}